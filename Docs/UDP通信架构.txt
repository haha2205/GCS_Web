┌─────────────────────────────────────────────────────────────────┐
│                      通信端口分配图                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  HTTP/WebSocket服务器:                                          │
│  ┌─────────────────────────────────────────┐                   │
│  │  Uvicorn: http://0.0.0.0:8000        │                   │
│  │  - REST API (HTTP)                      │                   │
│  │  - WebSocket (ws://)                    │                   │
│  └─────────────────────────────────────────┘                   │
│           ↓                                                    │
│  前端配置：                                                     │
│  - Host IP (地面站本机IP)                                        │
│  - Host Port (30509)                                            │
│                                                                 │
│  UDP服务器端口配置（可配置）：                                   │
│  ┌─────────────────────────────────────────┐                   │
│  │  30509: 地面站监听所有UDP数据（总入口）  │                   │
│  │  18506: 飞控遥测端口（ExtY_FCS_*）      │                   │
│  │  18507: LiDAR数据端口（障碍物信息）     │                   │
│  │  18511: 规划系统端口（规划响应）        │                   │
│  └─────────────────────────────────────────┘                   │
│                                                                 │
│  飞控端端口（无人机）：                                          │
│  ┌─────────────────────────────────────────┐                   │
│  │  18504: 接收地面站指令（ExtU_FCS）      │                   │
│  │  18506: 发送遥测数据                    │                   │
│  │  18507: 发送LiDAR数据                   │                   │
│  │  18510: 接收规划指令                    │                   │
│  │  18511: 发送规划响应                    │                   │
│  └─────────────────────────────────────────┘                   │
│                                                                 │
│  网络关系：                                                      │
│  地面站 IP: 127.0.0.1                                           │
│  无人机 IP: 127.0.0.2                                           │
│  两台设备在同一网段下                                             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘




┌─────────────────────────────────────────────────────────────────┐
│                    UDP 通信架构                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  后端（地面站）                     无人机（飞控）              │
│  127.0.0.1                        127.0.0.2                   │
│                                                                 │
│  UDP服务器（监听）                   UDP客户端                   │
│  ┌─────────────┐                    ┌─────────────┐             │
│  │  0.0.0.0:   │                    │  127.0.0.1: │             │
│  │            │                    │             │             │
│  │  • 30509   │<═══════════════════│  • 18506   │ (遥测)     │
│  │  • 18506   │                    │  (SEND_ONLY)│             │
│  │  • 18507   │<═══════════════════│  • 18507   │ (LiDAR)     │
│  │  • 18511   │                    │             │             │
│  └─────────────┘                    └──────┬──────┘             │
│       ↑                                     │                  │
│       │                                     │                  │
│       │  发送指令                           │  发送响应        │
│       ├──────────────────────────────────>│                  │
│       │ 127.0.0.2:18504  <════════════════┤                  │
│       │ (ExtU_FCS)                         │ (ExtY_FCS_*)     │
│       │                                    │                  │
│       │  发送规划指令                       │                  │
│       ├──────────────────────────────────>│                  │
│       │ 127.0.0.2:18510  <════════════════┤                  │
│       │ (GCSCommand)                       │ (GCSTelemetry)    │
│       │                                    │                  │
└─────────────────────────────────────────────┴──────────────────┘

